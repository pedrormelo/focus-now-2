<ion-content [fullscreen]="true" class="bg-background text-text-primary">
    <div
        class="relative mx-auto flex min-h-full w-full max-w-5xl flex-col justify-center gap-12 px-6 py-12 lg:flex-row lg:items-center lg:px-12 xl:px-16">
        <div class="hidden lg:block lg:max-w-xl">
            <app-logo class="mb-6" height="48"></app-logo>
            <h1 class="text-3xl font-semibold leading-tight md:text-4xl">Defina uma nova senha</h1>
            <p class="mt-2 text-base text-text-secondary">Crie uma senha forte para manter sua conta segura.</p>
        </div>

        <div class="relative w-full max-w-md self-center">
            <div
                class="absolute inset-x-10 -top-24 h-56 rounded-full bg-gradient-to-r from-brand-gradientStart via-brand-accent to-brand-gradientEnd opacity-20 blur-3xl">
            </div>
            <div
                class="relative overflow-hidden rounded-3xl border border-surface-border bg-surface/90 p-8 shadow-spotlight backdrop-blur">
                <div class="mb-8 space-y-2 lg:hidden">
                    <app-logo height="36"></app-logo>
                    <h2 class="text-2xl font-semibold">Redefinir senha</h2>
                    <p class="text-sm text-text-secondary">O link expira em 1 hora</p>
                </div>

                <form class="space-y-6" (ngSubmit)="submit()">
                    <div class="space-y-2">
                        <label for="newpass" class="text-sm font-medium text-text-primary">Nova senha</label>
                        <input id="newpass" name="newpass" type="password" [(ngModel)]="password" required
                            placeholder="Mínimo de 8 caracteres"
                            class="w-full rounded-2xl border border-surface-border bg-surface-subtle/60 px-4 py-3 text-sm text-text-primary placeholder:text-text-muted focus:border-brand-gradientStart focus:outline-none focus:ring-2 focus:ring-brand-gradientStart focus:ring-offset-0" />

                        <!-- Password strength meter -->
                        <div *ngIf="password" class="space-y-1">
                            <div class="h-2 w-full rounded-full bg-surface-subtle/70">
                                <div class="h-2 rounded-full transition-all"
                                    [ngStyle]="{ width: strength.width, background: strength.bg }"></div>
                            </div>
                            <div class="text-xs font-medium" [ngClass]="strength.textClass">{{ strength.label }}</div>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="confirmpass" class="text-sm font-medium text-text-primary">Confirmar senha</label>
                        <input id="confirmpass" name="confirmpass" type="password" [(ngModel)]="confirm" required
                            class="w-full rounded-2xl border border-surface-border bg-surface-subtle/60 px-4 py-3 text-sm text-text-primary placeholder:text-text-muted focus:border-brand-gradientStart focus:outline-none focus:ring-2 focus:ring-brand-gradientStart focus:ring-offset-0" />
                        <div *ngIf="confirm && confirm !== password" class="text-xs text-red-500">As senhas não conferem
                        </div>
                    </div>

                    <!-- Requisitos de senha para corresponder ao cadastro -->
                    <ul class="grid grid-cols-2 gap-1 text-xs text-text-muted">
                        <li [class.text-green-500]="requirements.length">• Mínimo 8 caracteres</li>
                        <li [class.text-green-500]="requirements.letter && requirements.number">• Pelo menos uma letra e um número</li>
                        <li [class.text-green-500]="requirements.special">• Pelo menos um caractere especial</li>
                    </ul>

                    <button type="submit"
                        class="group relative inline-flex w-full items-center justify-center overflow-hidden rounded-2xl bg-gradient-to-r from-brand-gradientStart via-brand-accent to-brand-gradientEnd px-4 py-3 text-base font-semibold text-white shadow-spotlight transition-all duration-200 hover:scale-[1.01] focus:outline-none focus-visible:ring-4 focus-visible:ring-brand-gradientStart/40"
                        [disabled]="!isValid()">
                        Salvar nova senha
                        <span
                            class="ml-3 inline-flex h-7 w-7 items-center justify-center rounded-full bg-white/15 text-sm font-semibold transition-transform group-hover:translate-x-1">→</span>
                    </button>
                </form>

                <div class="mt-6 text-center text-sm">
                    <button type="button"
                        class="rounded-xl px-2 py-2 text-text-muted transition-colors hover:text-brand-gradientStart"
                        (click)="goLogin()">Voltar ao login</button>
                </div>
            </div>
        </div>
    </div>
</ion-content>